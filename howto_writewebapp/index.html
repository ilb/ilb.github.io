<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title>Как написать web-приложение</title>
	<meta name="generator" content="LibreOffice 5.3.3.2 (Linux)"/>
	<meta name="author" content="slavb"/>
	<meta name="created" content="00:00:00"/>
	<meta name="changedby" content="Вячеслав Владимирович Борисов"/>
	<meta name="changed" content="2017-09-11T11:29:30.285569245"/>
	<meta name="keywords" content="webapp howto"/>
	<style type="text/css">
		h1 { direction: inherit }
		h2.cjk { font-family: "Droid Sans Fallback" }
		h2.ctl { font-family: "FreeSans" }
		h3.cjk { font-family: "Droid Sans Fallback" }
		h3.ctl { font-family: "FreeSans" }
		h4.cjk { font-family: "Droid Sans Fallback" }
		h4.ctl { font-family: "FreeSans" }
		pre.cjk { font-family: "Droid Sans Fallback", monospace }
		code.cjk { font-family: "Droid Sans Fallback", monospace }
	</style>
</head>
<body lang="ru-RU" dir="ltr">
<h1><a name="__RefHeading___Toc863_3640746453"></a>Как написать
Java web-приложение</h1>
<p><cite>One WAR to package them all, One WAR to serve them all,<br/>
One
WAR to deploy them all and in JNDI bind them. </cite>
</p>
<div id="Оглавление1" dir="ltr">
	<div id="Оглавление1_Head" dir="ltr">
		<p style="margin-top: 0.42cm; page-break-after: avoid"><font face="Albany, sans-serif"><font size="4" style="font-size: 14pt">Оглавление</font></font></p>
	</div>
	<p style="margin-bottom: 0cm"><a href="#__RefHeading___Toc863_3640746453">Как
	написать Java web-приложение	</a></p>
	<p style="margin-left: 0.5cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc335_3640746453">Процесс
	разработки программного обеспечения	</a></p>
	<p style="margin-left: 0.5cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc337_3640746453">Как
	создать Maven-проект из архетипа	</a></p>
	<p style="margin-left: 0.5cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc865_3640746453">Структура
	maven-проекта	</a></p>
	<p style="margin-left: 0.5cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc339_3640746453">Как
	добавить зависимости к Maven проекту	</a></p>
	<p style="margin-left: 0.5cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc341_3640746453">Как
	создать дескриптор web-приложения	</a></p>
	<p style="margin-left: 0.5cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc353_3640746453">Как
	подключить Persistance в проект	</a></p>
	<p style="margin-left: 0.5cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc357_3640746453">Моделирование
	JPA модели	</a></p>
	<p style="margin-left: 0.5cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc359_3640746453">Работа
	с JDBC	</a></p>
	<p style="margin-left: 1cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc361_3640746453">Как
	подключить JDBC ресурс в проект	</a></p>
	<p style="margin-left: 1cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc363_3640746453">Как
	подключить JDBC ресурс в Netbeans	</a></p>
	<p style="margin-left: 1cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc365_3640746453">Try-with-resources	</a></p>
	<p style="margin-left: 0.5cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc367_3640746453">Работа
	с maven	</a></p>
	<p style="margin-left: 1cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc369_3640746453">Выкладка
	артефактов в maven	</a></p>
	<p style="margin-left: 1cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc371_3640746453">Как
	добавить jar к Maven проекту	</a></p>
	<p style="margin-left: 1cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc373_3640746453">Как
	добавить Maven проект в Jenkins	</a></p>
	<p style="margin-left: 1cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc375_3640746453">Релизы
	(releases)	</a></p>
	<p style="margin-left: 1cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc377_3640746453">Как
	сделать бранч из релиза	</a></p>
	<p style="margin-left: 0.5cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc859_3640746453">Прочее	</a></p>
	<p style="margin-left: 1cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc379_3640746453">Работа
	с файловыми ресурсами приложения	</a></p>
	<p style="margin-left: 1cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc381_3640746453">HTTP-авторизация	</a></p>
	<p style="margin-left: 1cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc383_3640746453">Работа
	с реестром ресурсов	</a></p>
	<p style="margin-left: 1cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc443_3640746453">Логгирование	</a></p>
	<p style="margin-left: 1cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc345_3640746453">Как
	сгенерировать код по WADL	</a></p>
	<p style="margin-left: 1cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc385_3640746453">Как
	сгенерировать WSDL клиента	</a></p>
	<p style="margin-left: 0.5cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc389_3640746453">FAQ	</a></p>
	<p style="margin-left: 1cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc391_3640746453">В
	браузере не видны изменения xslt-шаблона	</a></p>
	<p style="margin-left: 1cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc393_3640746453">Что
	делать, если ресурс отвечает 404 или 500	</a></p>
	<p style="margin-left: 1cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc395_3640746453">При
	запуске приложения возникает ошибка:
	java.lang.NoClassDefFoundError	</a></p>
	<p style="margin-left: 1cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc397_3640746453">Ошибки
	локального томката	</a></p>
	<p style="margin-left: 0.5cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc399_3640746453">Фрагменты
	кода	</a></p>
	<p style="margin-left: 1cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc401_3640746453">Работа
	со строками	</a></p>
	<p style="margin-left: 1cm; margin-bottom: 0cm"><a href="#__RefHeading___Toc403_3640746453">Работа
	с датами java 8	</a></p>
</div>
<p><br/>
<br/>

</p>
<h2 class="western"><a name="__RefHeading___Toc335_3640746453"></a><a name="__RefHeading___Toc154_238497074"></a><a name="devprocess"></a>
Процесс разработки программного
обеспечения</h2>
<p>Процесс разработки ПО условно
разбивается на несколько стадий. 
</p>
<ol>
	<li/>
<p style="margin-bottom: 0cm"><b>Локальная разработка</b>
	- разработка и эксплуатация на локальном
	компьютере разработчика. Приложение
	запускается в IDE netbeans в локальном
	томкате, работает с локальным сервером
	БД (кроме крупных баз) 
	</p>
	<li/>
<p style="margin-bottom: 0cm"><b>Разработка</b> -
	эксплуатация и тестирование на общем
	сервере (devel) 
	</p>
	<li/>
<p style="margin-bottom: 0cm"><strike><b>Обкатка
	(staging)</b> - эксплуатация и тестирование
	на общем сервере (demo) </strike>
	</p>
	<li/>
<p><b>Эксплуатация (production)</b> - рабочая
	эксплуатация 
	</p>
</ol>
<h2 class="western"><a name="__RefHeading___Toc337_3640746453"></a><a name="__RefHeading___Toc158_238497074"></a><a name="mavenarchetype"></a>
Как создать Maven-проект из архетипа</h2>
<p>Для того чтобы не повторять перечисленные
в документе действия каждый раз, удобнее
создавать проекты из готового архетипа
Создать проект Netbeans: File - New Project. На 1 шаге
выбрать Maven - Project from Archetype. На 2 шаге в
строку поиска ввести <i>jparestresource</i> и
выбрать jparestresource-archetype (должен быть
настроен <a href="../../../mavenlibs/trunk/.m2/settings.xml">~/.m2/settings.xml</a>)
На 3 шаге заполняем Project Name, Project Location,
GroupId. <i>Важно: параметры Group Id и Packages
должны совпадать.</i></p>
<p>После создания проекта получается
готовое к запуску приложение. Скрипт
для создания БД лежит в {Other
sources}/src/main/resources/META-INF/sql/schema.sql. Данный
скрипт создает схему и одноименного
пользователя в БД mysql. Если нет локально
установленного сервера mysql, файле Web
Pages/META-INF/context.xml строчку localhost:3306 необходимо
заменить на devel:3306. 
</p>
<p><img src="howto_writewebapp_html_8ecd5d5a9fa557c7.png" name="Изображение1" align="left" width="680" height="464">
  <br clear="left"/>
</img>
<img src="howto_writewebapp_html_bc9f17a24fef8508.png" name="Изображение2" align="left" width="680" height="464">
  <br clear="left"/>
</img>
<br/>
<br/>

</p>
<p><br/>
<br/>

</p>
<h2 class="western"><a name="__RefHeading___Toc865_3640746453"></a>Структура
maven-проекта</h2>
<p>Созданный Maven-проект разделен в
интерфейсе на группы: Web Pages, Source Packages и
т.д. 
</p>
<p><img src="howto_writewebapp/project.png" name="Изображение4" alt="project.png" align="bottom" width="242" height="203" border="0"/>

</p>
<ol>
	<li/>
<p style="margin-bottom: 0cm"><strong>Web Pages</strong> -
	корень резвернутого web-приложения,
	здесь размещаются контекст приложения
	META-INF/context.xml дескриптор приложения
	WEB-INF/web.xml, статические ресурсы - schemas,
	stylesheets, jsp-страницы и др. 
	</p>
	<li/>
<p style="margin-bottom: 0cm"><strong>RESTful Web Services</strong>
	- дерево JAX-RS ресурсов приложения,
	строиться Netbeans по аннотациям классов
		</p>
	<li/>
<p style="margin-bottom: 0cm"><strong>Source Packages</strong>
	- исходный код приложения 
	</p>
	<li/>
<p style="margin-bottom: 0cm"><strong>Test Packages</strong> -
	автотесты 
	</p>
	<li/>
<p style="margin-bottom: 0cm"><strong>Other Sources</strong> -
	ресурсы приложения (содержимое
	src/main/resources при сборке war попадает в
	WEB-INF/classes и доступно в classpath) 
	</p>
	<li/>
<p style="margin-bottom: 0cm"><strong>Generated Sources</strong>
	- сгенерированные по схемам и wadl классы
	и интерфейсы приложения 
	</p>
	<li/>
<p style="margin-bottom: 0cm"><strong>Dependencies</strong> -
	подключенные библиотеки (зависимости)
		</p>
	<li/>
<p style="margin-bottom: 0cm"><strong>Java Dependencies</strong>
	- системные зависимости 
	</p>
	<li/>
<p><strong>Project Files</strong> - файлы проекта,
	самый интересный из них - pom.xml 
	</p>
</ol>
<p>Не все группы появляются сразу: RESTful
Web Services, Test Packages, Other Sources, Generated Sources
появляются при добавлении функционала
в проект. 
</p>
<h2 class="western"><a name="__RefHeading___Toc339_3640746453"></a><a name="__RefHeading___Toc166_238497074"></a><a name="mavendep"></a>
Как добавить зависимости к Maven проекту</h2>
<p><i>Примечание: обычно это делается
напрямую в pom.xml используя технический
прием copy — paste.</i></p>
<p>Чтобы добавить зависимость нужно
щелкнуть правой кнопкой мыши на группе
Dependencies в проекте и выбрать Add Dependency.
Откроектся окошко, где в поле Query нужно
ввести имя артефакта для поиска. 
</p>
<p><img src="howto_writewebapp/testappjava06.png" name="Изображение6" alt="testappjava06.png" align="bottom" width="589" height="550" border="0"/>

</p>
<p>Если нужна документация по API какой-либо
библиотеки в подсказках по Ctrl-пробел,
нужно щелкнуть правой кнопкой мыши на
библиотеке и скачать javadoc. После загрузки
javadoc на баночке с зависимостями  появиться
буква J: 
<img src="howto_writewebapp/javadepJ.png" name="Изображение7" alt="javadepJ.png" align="bottom" width="20" height="19" border="0"/>

. Там же можно скачать исходный код
библиотеки. Отдельно стоит зависимость
javaee-web-api. Если посмотреть ее свойства
(Properties в контестном меню) или в файле
pom.xml (в группе Project Files), видно что даная
зависимость имеет свойство scope: provided.
Это означает что данная библиотека уже
предоставляется сервлет-контейнером
(в частности tomcat) и не попадает в war файл.
</p>
<h2 class="western"><a name="__RefHeading___Toc341_3640746453"></a><a name="__RefHeading___Toc168_238497074"></a><a name="deploydescriptor"></a>
Как создать дескриптор web-приложения</h2>
<p><a name="__DdeLink__404_3640746453"></a><i>Примечание: в
приложении, создаваемом из архетипа,
дескриптор web.xml уже создан. Если приложение
разрабатывается из архетипа, данный
пункт следует прочесть только для
ознакомления.</i></p>
<p>Дескриптор сервлета - это файл {Web
Pages}/WEB-INF/web.xml. Он содержит информацию
названии, сервлетах приложения и другие
настройки. Чтобы произвести настройку
дескриптора сервлета, необходимо сначала
этот дескриптор создать: File - New File,
категория Web, Standart Deployment Descriptor (web.xml). 
</p>
<p><img src="howto_writewebapp/testappjava10.png" name="Изображение8" alt="testappjava10.png" align="bottom" width="725" height="493" border="0"/>

</p>
<p>После создания дескриптора откроется
редактор, через который можно настроить
web-приложение интерфейсно или в исходном
коде (вкладка Source). 
</p>
<h2 class="western"><a name="__RefHeading___Toc353_3640746453"></a><a name="__RefHeading___Toc188_238497074"></a><a name="jpaadd"></a>
Как подключить Persistance в проект</h2>
<p><i>Примечание: в приложении, создаваемом
из архетипа, дескриптор persistence.xml уже
создан. Если приложение разрабатывается
из архетипа, данный пункт следует
прочесть только для ознакомления.</i></p>
<p><i>Бибилиотека <a href="http://www.eclipse.org/eclipselink/jpa.php">eclipselink</a>
(в прошлом Oracle TopLink) является референсной
реализацией <a href="//ru.wikipedia.org/wiki/Java_Persistence_API">Java
Persistence API</a> 2.1 (JSR 338). </i>
</p>
<p>File - New File, категория Persistance, Persistance Unit.
На втором этапе указать имя - вместо
предложенного длинного имени можно
указать одноименное с проектом или
базой имя. В качестве соединиения указать
любое из списка или <a href="#jdbcide">создать
новое</a>, эта настройка все равно будет
заменена на <a href="#jdbc">JDBC ресурс</a>. Пример
<a href="howto_writewebapp/persistence.xml">persistence.xml</a> 
</p>
<p><img src="howto_writewebapp/jpa1.png" name="Изображение12" alt="jpa1.png" align="bottom" width="727" height="497" border="0"/>

<img src="howto_writewebapp/jpa2.png" name="Изображение13" alt="jpa2.png" align="bottom" width="791" height="442" border="0"/>

</p>
<h4 class="western"><a name="__RefHeading___Toc355_3640746453"></a><br/>
<br/>

</h4>
<p>Настройка генерации модели БД
производиться в файле persistance.xml. Файл
persistance.xml расположен в Other sources -&gt;
src/main/resources -&gt; META-INF -&gt; persistance.xml. При
старте JPA-приложения структура базы
может «актуализироваться», как при
запуске с &quot;пустой&quot; базой, так и с
базой находящейся в устаревшем состоянии
метаданных. Актуализация БД состоит из
1) актуализация структуры БД и 2)
актуализации справочников. Актуализация
структуры БД производиться eclipselink
автоматически (с исключениями*, см.
ниже). Для актуализации справочников
пишется скрипт, обычно создаваемый
&quot;дампом&quot; таблицы или используется
аннотация <a href="//github.com/ilb/common/blob/master/common-jpa/src/main/java/ru/ilb/common/jpa/annotations/AutoPopulableRepository.java">@AutoPopulableRepository</a>
на репозитории-справочнике. Параметры
генерации модели БД приведены в таблице:
</p>
<table cellpadding="2" cellspacing="2">
	<tr>
		<th style="border: none; padding: 0cm">
			<p>Параметр 
			</p>
		</th>
		<th style="border: none; padding: 0cm">
			<p>Значение 
			</p>
		</th>
	</tr>
	<tr>
		<td style="border: none; padding: 0cm">
			<p>javax.persistence.schema-generation.database.action</p>
		</td>
		<td style="border: none; padding: 0cm">
			<p>Режим генерации схемы БД из модели.
			Варианты значений: none, create, drop-and-create,
			drop, create-or-extend-tables. 
			</p>
			<p>Для обычных JPA-приложений, генерирующих
			БД по модели должно стоять значение
			<b>create-or-extend-tables</b>. Значение применяется
			для упрощения выкладки приложения.
			Так как каждая база может быть в своем
			историческом состоянии, то доведение
			ее до актуальной версии может быть не
			простым занятием. При значении
			create-or-extend-tables eclipselink в момент деплоя
			приложения досоздает в БД несуществующие
			таблицы и добавляет отсутствующие
			поля и индексы. Но при этом чистки от
			&quot;устаревших&quot; (выкинутых из модели
			БД таблиц, полей) не происходит, так
			как о них eclispelink &quot;не знает&quot;. Данная
			схема работает только в простых случаях
			- добавление таблицы, поля, индекса. В
			случае реструктуризации базы следует
			писать скрипт модификации метаданных
			вручную (или использовать другой
			инструмент поддержки версионности
			метаданных базы). 
			</p>
			<p>На этапе разработки, когда схема БД
			меняется значительно, предпочтительнее
			использовать <b>drop-and-create</b>. При данной
			настройки при каждом деплое приложения
			таблицы модели удаляются и создаются
			заного. После реструктуризации БД
			следует вернуть значение
			<b>create-or-extend-tables</b>. 
			</p>
			<p>Альтернативой drop-and-create может быть
			разовое удаление и пересоздание схемы
			БД, например скриптом из файла
			schema.sql. 
			</p>
		</td>
	</tr>
	<tr>
		<td style="border: none; padding: 0cm">
			<p>javax.persistence.sql-load-script-source</p>
		</td>
		<td style="border: none; padding: 0cm">
			<p>Путь к файлу инициализации данных.
			Пример значения: META-INF/sql/data.sql. Данный
			файл будет исполнен после создания
			модели БД. Основное назанчение данного
			файла - заполнение и до-заполнение
			справочных таблиц. Вставку данных
			рекомендуется делать запросами INSERT
			IGNORE ... с указанием первичного ключа
			записи для того чтобы повторные записи
			не дублировались и не заваливали лог
			ошибками при наличии записей. 
			</p>
		</td>
	</tr>
</table>
<h2 class="western"><a name="__RefHeading___Toc192_238497074"></a><a name="jpamodel"></a>
Моделирование JPA модели</h2>
<p>Описать сущности и взаимосвязи между
ними. См.
<a href="//jeddict.github.io/page.html?l=tutorial/QuickStart#CE">https://jeddict.github.io/page.html?l=tutorial/QuickStart#CE</a></p>
<p>Наиболее часто используемые связи</p>
<h3 class="western">Много-к-одному</h3>
<p>M:1 — наиболее частая связь между
сущностями. Может быть односторонней
и двухсторонней. Отличие двухсторонней
связи заключается в том, что одновременно
создается обратная связь 1:M.</p>
<p><span style="font-style: normal">Двухсторонняя связь
M:1 сложнее. Работа с ней (при включенном
кэше) требует внимательного заполнения
обоих сторон связи.</span><span style="font-style: normal">
</span><span style="font-style: normal">Двустороннюю
связь следует делать при необходимости
работать в коде с коллекцией вложенных
сущностей. Т.к. данная коллекция
кэшируется, работа с ней не приводит к
дополнительным sql-запросам. Пример:
сущность Документ содержит несколько
Файлов. Бизнес-логика работы с документом
обращается к вложенным файлам. В этом
случае создается двухсторонняя связь
М:1 в сущности Файл </span><span style="font-style: normal">(document)</span><span style="font-style: normal">.
 При этом в сущности Документ автоматически
</span><span style="font-style: normal">создается связанный
 </span><span style="font-style: normal">список вложенных
</span><span style="font-style: normal">Файлов</span><span style="font-style: normal">
</span><span style="font-style: normal">(docfiles)</span><span style="font-style: normal">.</span></p>
<h3 class="western"><img src="howto_writewebapp_html_24d4d512f12e15df.png" name="Изображение3" align="left" width="680" height="369">
  <br clear="left"/>
</img>
<span style="font-style: normal">Много</span><span style="font-style: normal">-ко-многим</span></h3>
<p><i>Как правило, связь М:М не примяется.
Технически данная связь реализуется
через таблицу-связку, но в данную связку
нельзя добавлять собственные свойства.
Данную связь можно заменить двумя
связями много-к-одному. Пример: сущность
Документ (Document) и Хозяйствующий
субъект(BusinessEntity) связаны отношением
М:М. Создается Сущность EntityDocument, содержащая
две двух-сторонние связи М:1: document и
businessEntity.</i></p>
<h3 class="western">Один-ко-многим</h3>
<p><i>Как правило, односторонная связь
1:M не применяется. Наиболее часто
используется двух-сторонняя связь M:1.</i></p>
<h3 class="western">Наследование</h3>
<p>Как правило при разработке модели
предметной области выделяются сущности,
имеющие одинаковые базовые сущности.
Пример: Физическое лицо и Кампания
наследуют один класс Хозяйствующий
субъект.</p>
<p>Рассмотрим 2 ошибки, которых следует
избегать при проектировании:</p>
<p>Ошибка N1: Работа с базовым классом 
Хозяйствующий субъект</p>
<p>Отсутствие различий  между видами
хозяйствующих субъектов на начальных
этапах жизни проекта может привести к
желанию работать напрямую с базовым
классом  Хозяйствующий субъект. Это
может в будущем стоить необходимости
рефакторинга и повторного тестирования
ПО.</p>
<p>Ошибка N2. Не выделение базового класса</p>
<p>Проектирование не связанных наследованием
классов  Физическое лицо и Кампания
приведет к невозможности ссылаться на
разные типы хозяйствующих субъектов.
Например, поручителем по заявке может
выступать физическое и юридическое
лицо.</p>
<h2 class="western"><a name="__RefHeading___Toc359_3640746453"></a><a name="__RefHeading___Toc198_238497074"></a><a name="jdbc"></a>
Работа с JDBC</h2>
<h3 class="western"><a name="__RefHeading___Toc361_3640746453"></a><a name="__RefHeading___Toc200_238497074"></a><a name="jdbcresource"></a>
Как подключить JDBC ресурс в проект</h3>
<p>JDBC ресурсы могут быть описаны в самом
приложении в файле {Web pages}/META-INF/context.xml,
в файле ${CATALINA_BASE}/conf/context.xml и в блоке
<strong>GlobalNamingResources</strong> файла
${CATALINA_BASE}/conf/server.xml. Отличие
${CATALINA_BASE}/conf/context.xml от
${CATALINA_BASE}/conf/server.xml в том, что context.xml
перечитываетя при каждом деплое
приложения, а server.xml только при рестарте
сервера. Описание ресурса в каталоге
${CATALINA_BASE} имеет приоритет над {Web
pages}/META-INF/context.xml, расложенном в приложении.
Поэтому для удобства разработки и
тестирования JDBC ресурс следует размещать
в приложении (с пустым или неправильным
паролем, например &quot;changeit&quot;), а при
выкладке данный ресурс будет настраиваться
администратором в каталоге ${CATALINA_BASE}. 
</p>
<h3 class="western"><a name="__RefHeading___Toc363_3640746453"></a><a name="__RefHeading___Toc202_238497074"></a><a name="jdbcide"></a>
Как подключить JDBC ресурс в Netbeans</h3>
<p>Services -&gt; Databases -&gt; New connection. Если нет
драйвера (например Firebird), на первом
экране его можно добавить, указав путь
к jar файлу, например
/opt/tomcat-8/common/lib/jaybird-full-2.2.1.jar.</p>
<p> 
<img src="howto_writewebapp/jdbcconn1.png" name="Изображение14" alt="jdbcconn1.png" align="bottom" width="606" height="453" border="0"/>

<img src="howto_writewebapp/jdbcconn2.png" name="Изображение15" alt="jdbcconn2.png" align="bottom" width="606" height="453" border="0"/>

</p>
<h3 class="western"><a name="__RefHeading___Toc365_3640746453"></a><a name="__RefHeading___Toc204_238497074"></a><a name="trywithresources"></a>
Try-with-resources</h3>
<p>В Java 7 появилось удобное выражение
&quot;<a href="http://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html">try-with-resources</a>&quot;.
Для того чтобы не писать блоки finally {}
вызывающие метод close(), нужно писать блок
try с ресурсом, например: 
</p>
<pre class="western" style="margin-bottom: 0.5cm">        try (Connection conn = dataSource.getConnection()) {
            try (Statement stmt = conn.createStatement()) {
            }
        }</pre><h2 class="western">
<a name="__RefHeading___Toc367_3640746453"></a>Работа с maven</h2>
<h3 class="western"><a name="__RefHeading___Toc369_3640746453"></a><a name="__RefHeading___Toc208_238497074"></a><a name="mevenartifactdeploy"></a>
Выкладка артефактов в maven</h3>
<p>При сборке проекта в Netbeans собранный
артефакт (war или jar файл) автоматически
размещается в локальный maven-репозиторий.
</p>
<p>Выкладка артефакта из консоли: <code class="western">mvn
deploy</code>. Из netbeans: щелчок правой кнопкой
на проекте: Custom -&gt; Goals -&gt; в поле Goals
ввести deploy и нажать OK. В репозиторий
snapshots можно грузить только артефакты с
версией SNAPSHOT (иначе будет выдана ошибка
400 Bad Request, описание ошибки нужно смотреть
в логе nexus на сервере) 
</p>
<h3 class="western"><a name="__RefHeading___Toc371_3640746453"></a><a name="__RefHeading___Toc212_238497074"></a><a name="mavendepjar"></a>
Как добавить jar к Maven проекту</h3>
<p>Если нужная библиотека не находиться
в центральном Maven-репозитории, например
cryptopro или jawin, ее можно установить в
сетевой или локальный maven-репозиторий.
</p>
<p>Для установки стороннего jar-файла в
сетевой maven-репозиторий используется
команда: <code class="western">mvn -DartifactId=$artifactId
-DgroupId=$groupId -Dversion=$version -Dpackaging=jar -Dfile=$jar
-DgeneratePom=</code><code class="western">true</code><code class="western">
-DrepositoryId=nexus-snapshots
-Durl=http://devel.net.ilb.ru:28052/nexus/content/repositories/thirdparty
deploy:deploy-file</code>, где $artifactId, $groupId, $version -
атрибуты артефакта, которые потом нужно
будет указать в pom.xml, $jar - локальный путь
к jar-файлу. При этом в ~/.m2/settings.xml должна
быть запись с авторизационой информацией:
</p>
<pre class="western"><code class="western">       </code><code class="western">&lt;server&gt;</code>
<code class="western">            </code><code class="western">&lt;id&gt;nexus-snapshots&lt;/id&gt;</code>
<code class="western">            </code><code class="western">&lt;username&gt;deployment&lt;/username&gt;</code>
<code class="western">            </code><code class="western">&lt;password&gt;deployment123&lt;/password&gt;</code>
<code class="western">        </code><code class="western">&lt;/server&gt;</code>
        </pre><p>
Установка в локальный maven-репозиторий,
вариант с GUI:</p>
<ol>
	<li/>
<p style="margin-bottom: 0cm">Открыть диалог
	&quot;Dependencies&quot; -&gt; &quot;Add Dependency&quot; 
	</p>
	<li/>
<p style="margin-bottom: 0cm">Заполнить поля
	groupId, artifactId и version (поискать примеры &quot;<strong>имя
	библиотеки</strong> maven&quot; в google, например
	&quot;cryptopro maven&quot; или ввести любые данные)
		</p>
	<li/>
<p style="margin-bottom: 0cm">Зависимость будет
	добавлена в pom.xml и появиться в группе
	Dependencies 
	</p>
	<li/>
<p>Щелкнуть правой кнопкой мыши по
	зависимости, выбрать &quot;manually install
	artifact&quot; и указать путь к jar. Jar установиться
	в локальный Maven-репозиторий 
	</p>
</ol>
<h3 class="western"><a name="__RefHeading___Toc373_3640746453"></a><a name="__RefHeading___Toc214_238497074"></a><a name="maventojenkin"></a>
Как добавить Maven проект в Jenkins</h3>
<ol>
	<li/>
<p style="margin-bottom: 0cm">Создать Job 
	</p>
	<li/>
<p style="margin-bottom: 0cm">Указать &quot;Имя
	Job'а&quot; и выбрать &quot;Создать проект
	maven2/3&quot; 
	</p>
	<li/>
<p style="margin-bottom: 0cm">Заполнить &quot;URL
	репозитория&quot; в &quot;Управление исходным
	кодом / Subversion&quot; 
	</p>
	<li/>
<p style="margin-bottom: 0cm">Заполнить галочки
	&quot;Опрашивать SCM об изменениях&quot; -
	указать H 0 * * * (в репозитории должен
	быть включен хук!) 
	</p>
	<li/>
<p style="margin-bottom: 0cm">Для библиотек (jar):
	&quot;Добавить шаг после сборки&quot;, &quot;Deploy
	arifacts to Maven repository&quot; 
	</p>
	<li/>
<p style="margin-bottom: 0cm">Для сервисов (war):
	&quot;Add post-build step&quot;, &quot;Вызвать цели Maven
	верхнего уровня&quot; , указать цель
	&quot;tomcat:redeploy&quot; для автоматической
	выкладки на devel tomcat 
	</p>
	<li/>
<p style="margin-bottom: 0cm">Если приложение
	содержит авто-тесты, которые по-умолчанию
	выключены, заполнить Goals and options: <code class="western">clean
	install -D maven.test.skip=false</code> 
	</p>
	<li/>
<p style="margin-bottom: 0cm">E-mail Notification: добавить
	галочку &quot;Send separate e-mails to individuals who broke
	the build&quot; 
	</p>
	<li/>
<p style="margin-bottom: 0cm">&quot;Сохранить&quot; 
	</p>
	<li/>
<p style="margin-bottom: 0cm">На странице проекта
	выбрать в левом меню &quot;Собрать сейчас&quot;
		</p>
	<li/>
<p>После окончания сборки, ее лог
	можно посмотреть в контекстном меню
	&quot;Вывод на консоль&quot; 
	</p>
</ol>
<h3 class="western"><a name="__RefHeading___Toc375_3640746453"></a><a name="__RefHeading___Toc218_238497074"></a><a name="release"></a>
Релизы (releases)</h3>
<p>Два варианта создания релиза</p>
<ul>
	<li/>
<p style="margin-bottom: 0cm">В контекстном меню
	проекта Custom/Goals... 
	</p>
	<ul>
		<li/>
<p style="margin-bottom: 0cm">выполнить
		&quot;release:prepare release:perform&quot; (можно одной
		командой)</p>
		<li/>
<p style="margin-bottom: 0cm">Будет 3 вопроса по
		номерам версий, с предложенными
		ответами, скорее всего подойдут ответы
		по умолчанию. Например, идет разработка
		релиза &quot;1.4-SNAPSHOT&quot;. 
		</p>
		<ul>
			<li/>
<p style="margin-bottom: 0cm">Версия релиза
			будет &quot;1.4&quot; 
			</p>
			<li/>
<p style="margin-bottom: 0cm">Версия подставляемая
			к названию проекта в &quot;tags&quot; &quot;1.4&quot;
						</p>
			<li/>
<p style="margin-bottom: 0cm">Новая версия
			разработки &quot;1.5-SNAPSHOT&quot; 
			</p>
		</ul>
		<p style="margin-bottom: 0cm">Создастся ветка в
		&quot;tags&quot;, выложиться релиз в репозиторий
		<a href="http://devel.net.ilb.ru:28052/nexus/content/repositories/releases/">http://devel.net.ilb.ru:28052/nexus/content/repositories/releases/</a></p>
	</ul>
	<li/>
<p style="margin-bottom: 0cm">В Jenkins/Настройки
	проекта включить &quot;Maven release build&quot; 
	</p>
	<ul>
		<li/>
<p style="margin-bottom: 0cm">В раздел &quot;Pre
		Steps&quot; добавить команду &quot;svn upgrade&quot;
		(В Jenkins &quot;Subversion Workspace Version&quot; - 1.7, а
		плагин &quot;Maven Release&quot; использует svn
		установленный в системе, более новой
		версии) 
		</p>
		<li/>
<p style="margin-bottom: 0cm">В меню проекта
		появиться пункт &quot;Perform Maven Release&quot; 
		</p>
		<ul>
			<li/>
<p style="margin-bottom: 0cm">Выбрать номера
			версий (скорее всего подойдут
			предложенные) 
			</p>
			<li/>
<p style="margin-bottom: 0cm">Dry run only? - протестировать
			сборку (без фиксации, можно выполнять
			под пользователем Jenkins, то есть свою
			учетку не указывать) 
			</p>
			<li/>
<p>После выполнения. Создастся ветка
			в &quot;tags&quot;, выложиться релиз в
			репозиторий
			<a href="http://devel.net.ilb.ru:28052/nexus/content/repositories/releases/">http://devel.net.ilb.ru:28052/nexus/content/repositories/releases/</a></p>
		</ul>
	</ul>
</ul>
<h3 class="western"><a name="__RefHeading___Toc377_3640746453"></a><a name="__RefHeading___Toc220_238497074"></a><a name="releasebranch"></a>
Как сделать бранч из релиза</h3>
<ol>
	<li/>
<p style="margin-bottom: 0cm">Создать папку
	branches, если ее еще нет: svn mkdir
	https://svn.ilb.ru/repos/ics_service_web/branches/ Иначе будет
	ошибка E160013: File not found: transaction '90-2q', path
	'/branches/ics-service-web-1.11' 
	</p>
	<li/>
<p style="margin-bottom: 0cm">Прописать в
	~/.subversion/servers настройку&nbsp;
	ssl-client-cert-password=&lt;password&gt; 
	</p>
	<li/>
<p style="margin-bottom: 0cm">Перейти в локальный
	каталог tags/ics-service-web-1.11/ 
	</p>
	<li/>
<p style="margin-bottom: 0cm">Выполнить команду
	mvn release:branch -DbranchName=ics-service-web-1.11
	-DupdateBranchVersions=true -DupdateWorkingCopyVersions=false
	-DautoVersionSubmodules=true -DreleaseVersion=1.11.1-SNAPSHOT, будет
	создан бранч 
	</p>
	<li/>
<p style="margin-bottom: 0cm">Примержить изменения
	из trunk 
	</p>
	<li/>
<p style="margin-bottom: 0cm">Добавить бранч в
	jenkins, или изменить url в старом бранче 
	</p>
	<li/>
<p>Сделать релиз 
	</p>
</ol>
<h2 class="western"><a name="__RefHeading___Toc859_3640746453"></a>Прочее</h2>
<h3 class="western"><a name="__RefHeading___Toc379_3640746453"></a><a name="__RefHeading___Toc222_238497074"></a><a name="resource"></a>
Работа с файловыми ресурсами приложения</h3>
<p>Ресурс - это произвольный файл, например
sql-запрос, изображение и др. Ресурсы
maven-проекта располагаются в {Other
Sources}/{src/main/resources}. При сборке war-файла
содержимое данного каталога копируется
в каталог WEB-INF/classes, таким образом данные
ресурсы становяться доступны стандартным
classloader-ом java. 
</p>
<p>Для размещения ресурса необходимо
сначала создать Java Package в каталоге {Other
Sources}/{src/main/resources}, и внутри Java Package
разместить файл ресурса. Если ресурс
используется определенным классом,
данный ресурс можно разместить в
одноименном с классом package. Например,
для того чтобы получить путь к ресурсу
report.sql, распологающемуся в одноименном
package класса: 
</p>
<pre class="western">            
try (InputStream is = this.getClass().getClassLoader().getResourceAsStream(file)) { }</pre><h3 class="western">
<a name="__RefHeading___Toc381_3640746453"></a><a name="__RefHeading___Toc224_238497074"></a><a name="auth"></a>
HTTP-авторизация</h3>
<p>Для того чтобы включить HTTP-авторизацию
в сервисе, необходимо в дескриптор
приложения WEB-INF/web.xml добавить настройку
</p>
<pre class="western">            
    &lt;security-constraint&gt;
        &lt;display-name&gt;Tomcat Server Configuration Security Constraint&lt;/display-name&gt;
        &lt;web-resource-collection&gt;
            &lt;web-resource-name&gt;jparestresource&lt;/web-resource-name&gt;
            &lt;url-pattern&gt;/web/*&lt;/url-pattern&gt;
        &lt;/web-resource-collection&gt;
        &lt;auth-constraint&gt;
            &lt;role-name&gt;*&lt;/role-name&gt;
        &lt;/auth-constraint&gt;
    &lt;/security-constraint&gt;
    &lt;login-config&gt;
        &lt;auth-method&gt;BASIC&lt;/auth-method&gt;
        &lt;realm-name&gt;jparestresource&lt;/realm-name&gt;
    &lt;/login-config&gt;
    &lt;security-role&gt;
        &lt;description&gt;anyrole&lt;/description&gt;
        &lt;role-name&gt;*&lt;/role-name&gt;
    &lt;/security-role&gt;
<code class="western">            </code>
        </pre><p>
В качестве role-name можно указать конкретную
роль, трубуемую для совершения действия.
Параметры login-config и security-role нужны на
этапе разработки и тестирования (при
запуске в локальном томкате без AJP и
модуля tomcatrealm). Логин, пароль и группы
пользователя для тестирования необходимо
завести в ${CATALINA_BASE}/conf/tomcat-users.xml. В данном
файле уже есть пример записи - пользователь
ide. Данную запись необходимо скопировать,
исправить атрибут <b>username</b> (пароль можно
не менять) и заполнить атрибут <b>roles</b>
необходимыми группами через запятую.
При исполнении через apache (AJP) данные
настройки игнорируются, авторизация и
опеределние групп идет через LDAP (posix)
См. <a href="../../../tomcatrealm">tomcatrealm</a>. 
</p>
<p>Для того чтобы получить логин
авторизованного пользователя и его
группы необходимо в класс ресурса
добавить свойство @Context private HttpServletRequest
hsreq или воспользоваться ContainerRequestFilter.</p>
<p>Пример: 
</p>
<p style="margin-bottom: 0cm">public class AuthorizationHandler
implements ContainerRequestFilter {</p>
<p style="margin-bottom: 0cm">    @Override</p>
<p style="margin-bottom: 0cm">    public void
filter(ContainerRequestContext requestContext) throws IOException {</p>
<p style="margin-bottom: 0cm">        SecurityContext securityContext
= requestContext.getSecurityContext();</p>
<p style="margin-bottom: 0cm">        String userName = null;</p>
<p style="margin-bottom: 0cm">        if
(securityContext.getUserPrincipal() != null) {</p>
<p style="margin-bottom: 0cm">            userName =
securityContext.getUserPrincipal().getName();</p>
<p style="margin-bottom: 0cm">         }</p>
<p style="margin-bottom: 0cm">    }</p>
<p style="margin-bottom: 0cm">}</p>
<h3 class="western"><a name="__RefHeading___Toc383_3640746453"></a><a name="__RefHeading___Toc226_238497074"></a><a name="resourcerepository"></a>
Работа с реестром ресурсов</h3>
<p><a href="../drafts/webapp.xhtml#java">Работа с реестром
ресурсов</a> 
</p>
<h3 class="western"><a name="__RefHeading___Toc443_3640746453"></a>Логгирование</h3>
<p><a href="#mavendep">Подключить зависимость</a>
logback-classic или просто скопировать в
pom.xml: 
</p>
<pre class="western"><code class="western">                </code><code class="western">&lt;dependency&gt;</code>
<code class="western">                    </code><code class="western">&lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;</code>
<code class="western">                    </code><code class="western">&lt;artifactId&gt;logback-classic&lt;/artifactId&gt;</code>
<code class="western">                    </code><code class="western">&lt;version&gt;1.1.3&lt;/version&gt;</code>
<code class="western">                </code><code class="western">&lt;/dependency&gt;</code><code class="western">            </code>
        </pre><p>
Подложить конфиг <a href="../../../testapp/trunk/testappjava/src/main/resources/logback.xml">logback.xml</a>
в Other Sources -&gt; src/main/resources -&gt; <strong>default
package</strong>. Для этого можно вызвать
контекстное меню на каталоге
src/main/resources, выбрать New -&gt; XML Document, ввести
имя logback и в созданный файл вставить
содержимое из примера. 
</p>
<p>Использование: объявить в классе
переменную: 
</p>
<p>private static final Logger LOG =
LoggerFactory.getLogger(DocumentsResourceImpl.class);</p>
<p>и логгировать: 
</p>
<pre class="western">LOG.info(&quot;TEST&quot;);</pre><h3 class="western">
<a name="__RefHeading___Toc345_3640746453"></a><a name="__RefHeading___Toc176_238497074"></a><a name="wadlfirst"></a>
Как сгенерировать код по WADL</h3>
<p>По WSDL уже давно можно генерировать
код <a href="#wsdlclient">клиента</a> и сервера
прямо из интерфейса IDE. <a href="http://stackoverflow.com/questions/9159881/restful-client-from-wadl">А
можно ли так же круто генерировать код
REST-клиента и сервера по WADL?</a>  С
использованием maven-плагина
cxf-wadl2java-plugin можно генерировать серверный
код и объектную модель данных по
технологии <a href="http://cxf.apache.org/docs/jaxrs-services-description.html#JAXRSServicesDescription-WADL-firstDevelopment">WADL-first
Development</a>. Так же ограниченный функционал
по генерации REST-клиента есть в Netbeans, но
пока в нем отсутствует генерация модели
данных по вложенным в WADL схемам. То есть,
хотя при генерации кода вызова REST-сервиса
из репозитория сервисов, например
клиента Google Map, объектная модель
добавляется в проект, но она не генерируется
автоматом, она вложена в виде jar-файла
в описание сервиса. Генерация кода по
WADL есть и для других языков (php, javascript),
но без объектной модели этот код просто
&quot;заглушка&quot;. 
</p>
<p>Реализация интерфейса сервиса ничем
не отличается от реализации любого
другого интерфейса в Java. Класс-реализацию
можно сделать вручную или с помощью
подсказки Netbeans. Во многих местах кода
Netbeans показывает &quot;лампочку&quot;  с
подсказками. Если встать курсором на
имя сгенерированного интерфейса
DocumentResource, слева загорается лампочка,
выбираем в ней Implement interface. В появившемся
окошке жмем OK. Так как сгенерированный
класс-реализация создался там же в
каталоге Generated Sources и при следующией
генерации он стерется, нужно перетащить
его в каталог Source Packages в пакет
ru.ilb.testappjava и исправить ошибки по подсказкам
в лампочках.Так же нужно продублировать
у класса аннотацию @Path(&quot;document&quot;).</p>
<p>Данные действия нужно произвести
разово для каждого <strong>корневого</strong>
ресурса WADL. Добавление новых методов в
корневой ресурс делается в уже существующем
классе с использованием подсказки
&quot;Implement all abstract methods&quot;.</p>
<h3 class="western"><a name="__RefHeading___Toc385_3640746453"></a><a name="__RefHeading___Toc228_238497074"></a><a name="wsdlclient"></a>
Как сгенерировать WSDL клиента</h3>
<p>Шаг 1 - в меню File - New File выбрать категорию
Web Services, в ней выбрать Web Service Client. 
</p>
<p><img src="howto_writewebapp/smevlib03.png" name="Изображение17" alt="smevlib03.png" align="bottom" width="805" height="577" border="0"/>

</p>
<p>Шаг 2: Указываем URL wsdl сервиса или
локального файла и жмем Finish. 
</p>
<p><img src="howto_writewebapp/smevlib04.png" name="Изображение18" alt="smevlib04.png" align="bottom" width="858" height="577" border="0"/>

</p>
<h4 class="western"><br/>
<br/>

</h4>
<p><a name="__RefHeading___Toc230_238497074"></a><a name="wsdlclientcall"></a>
Как сгенерировать код вызова WSDL сервиса:
перетащить мышкой в Netbeans нужный сервис
в текст программы: 
</p>
<p><img src="howto_writewebapp/smevweb04.png" name="Изображение19" alt="smevweb04.png" align="bottom" width="327" height="216" border="0"/>

</p>
<h2 class="western"><a name="__RefHeading___Toc389_3640746453"></a><a name="__RefHeading___Toc232_238497074"></a><a name="faq"></a>
FAQ</h2>
<h3 class="western"><a name="__RefHeading___Toc391_3640746453"></a><a name="__RefHeading___Toc234_238497074"></a><a name="xsltcache"></a>
В браузере не видны изменения xslt-шаблона</h3>
<p><a name="__DdeLink__220_3640746453"></a>По-умолчанию,
для повышения производительности, xslt
шаблоны кэшируются в серверном
трансформере. Для того что бы у разработчика
в режиме deploy-on-save можно было сразу видеть
изменения, в файле ${catalina.base}/conf/context.xml
необходимо прописать параметр
refreshTemplates=true</p>
<h3 class="western"><a name="__RefHeading___Toc393_3640746453"></a><a name="__RefHeading___Toc238_238497074"></a><a name="resourceerror"></a>
Что делать, если ресурс отвечает 404 или
500</h3>
<p>Если все сделано по инструкции, а
ресурс в браузере отвечает 404, 500 или
другую ошибку, необходимо проверить,
есть ли ошибки при старте приложения
или в момент обращения к сервису. Это
можно видеть во вкладке <strong>Output - Apache
Tomcat</strong>. Если такой вкладки нет, нужно
открыть блок Services (Ctrl-5), развернуть
Server -&gt; Tomcat и выбрать View Server Output. В данном
логе пишуться отладочные сообщения при
старте сервлета и трейсы от исключений.
Они бывают довольно длинные, но весь
трейс изучать не нужно. В трейсе нужно
найти знакомый класс (он будет подчеркнут
ссылкой) и мышкой перейти в него для
поиска причины ошибки. Если ни одного
знакомого класса нет, нужно искать текст
ошибки в Google. Во вкладке <strong>Output - Apache
Tomcat Log</strong> можно видеть журнал приложения,
если оно пользуется им (например через
Logger). 
</p>
<p>Если при открытии ресурса выходит
ошибка &quot;No root resource matching request path {} has been
found&quot;, необходимо проверить наличие
аннотации @Path у класса-ресурса (аннтация
ресурса должна дублировать аннотацию
интерфейса). 
</p>
<h3 class="western"><a name="__RefHeading___Toc395_3640746453"></a><a name="__RefHeading___Toc240_238497074"></a><a name="noclassdeffounderror"></a>
При запуске приложения возникает ошибка:
java.lang.NoClassDefFoundError</h3>
<ol>
	<li/>
<p style="margin-bottom: 0cm"><strong>java.lang.NoClassDefFoundError:
	javax/persistence/spi/PersistenceUnitInfo</strong> - нет
	библиотек eclipselink-2.5.1.jar,
	javax.persistence-2.1.0.jar в томкате. 
	</p>
	<li/>
<p style="margin-bottom: 0cm"><strong>java.lang.ClassNotFoundException:
	com.mysql.jdbc.Driver</strong>: нет библиотеки
	mysql-connector-java-5.1.31.jar в томкате. 
	</p>
	<li/>
<p><strong>java.lang.ClassNotFoundException:
	org.firebirdsql.gds.GDSException</strong>: нет библиотеки
	jaybird-full-2.2.5.jar в томкате. 
	</p>
</ol>
<p>Необходимо обновить /opt/tomcat-8/common/lib/ 
</p>
<h3 class="western"><a name="__RefHeading___Toc397_3640746453"></a><a name="__RefHeading___Toc242_238497074"></a><a name="tomcat"></a>
Ошибки локального томката</h3>
<ol>
	<li/>
<p style="margin-bottom: 0cm">Томкат долго
	стартует: возможно накопилось много
	задеплоеных приложений: Services -&gt; Servers
	-&gt; Apache Tomcat or TomEE -&gt; Web Applications -&gt;
	контекстное меню Undeploy на не нужных. 
	</p>
	<li/>
<p style="margin-bottom: 0cm">Томкат долго деплоит
	приложение: возможно происходит утечка
	памяти от постоянного Deploy On Save - нужно
	рестартануть томкат. 
	</p>
	<li/>
<p style="margin-bottom: 0cm">Приложение запущено
	в режиме Debug но отладчик на точках
	останова не останавливается: рестартануть
	томкат. 
	</p>
	<li/>
<p>Томкат не останавливается: Services
	-&gt; Servers -&gt; Apache Tomcat or TomEE -&gt; контекстное
	меню Terminate (или через панель задач
	отфильтровать процесс java и завершить)
		</p>
</ol>
<h2 class="western"><a name="__RefHeading___Toc399_3640746453"></a><a name="__RefHeading___Toc244_238497074"></a><a name="codesnippets"></a>
Фрагменты кода</h2>
<h3 class="western"><a name="__RefHeading___Toc401_3640746453"></a><a name="__RefHeading___Toc246_238497074"></a><a name="codesnippets.string"></a>
Работа со строками</h3>
<ol>
	<li/>
<p>Как прочитать InputStream в строку<br/>
<code class="western">String
	result=new
	java.util.Scanner(inputStream,&quot;UTF-8&quot;).useDelimiter(&quot;\\A&quot;).next()</code>
		</p>
</ol>
<h3 class="western"><a name="__RefHeading___Toc403_3640746453"></a><a name="__RefHeading___Toc248_238497074"></a><a name="codesnippets.java8date"></a>
Работа с датами java 8</h3>
<ol>
	<li/>
<p style="margin-bottom: 0cm"><a href="//github.com/marschall/threeten-jpa#usage">JPA
	AttributeConverter</a> 
	</p>
	<li/>
<p><a href="//github.com/migesok/jaxb-java-time-adapters">JAXB
	XmlAdapter</a> 
	</p>
</ol>
<p>Подключение JPA AttributeConverter через
persistence.xml (есть так же вариант в orm.xml):</p>
<pre class="western">            
<code class="western">    </code><code class="western">&lt;class&gt;com.github.marschall.threeten.jpa.LocalTimeConverter&lt;/class&gt;</code>
<code class="western">    </code><code class="western">&lt;class&gt;com.github.marschall.threeten.jpa.LocalDateConverter&lt;/class&gt;</code>
<code class="western">    </code><code class="western">&lt;class&gt;com.github.marschall.threeten.jpa.LocalDateTimeConverter&lt;/class&gt;</code><code class="western">     </code>
        </pre><p>
Подключение JAXB XmlAdapter через package-info.java:</p>
<pre class="western">@XmlJavaTypeAdapters({
    @XmlJavaTypeAdapter(type = LocalDate.class, value = LocalDateXmlAdapter.class),
    @XmlJavaTypeAdapter(type = LocalTime.class, value = LocalTimeXmlAdapter.class),
    @XmlJavaTypeAdapter(type = LocalDateTime.class, value = LocalDateTimeXmlAdapter.class)
})
@XmlSchemaTypes({
    @XmlSchemaType(name = &quot;date&quot;, type = LocalDate.class),
    @XmlSchemaType(name = &quot;time&quot;, type = LocalTime.class),
    @XmlSchemaType(name = &quot;dateTime&quot;, type = LocalDateTime.class)
})        </pre><p>
Подключение JAXB XmlAdapter через bindings.xml:</p>
<pre class="western" style="margin-bottom: 0.5cm">        &lt;xjc:javaType name=&quot;java.time.LocalDate&quot; xmlType=&quot;xsd:date&quot; adapter=&quot;com.migesok.jaxb.adapter.javatime.LocalDateXmlAdapter&quot; /&gt;
        &lt;xjc:javaType name=&quot;java.time.LocalDateTime&quot; xmlType=&quot;xsd:dateTime&quot; adapter=&quot;com.migesok.jaxb.adapter.javatime.LocalDateTimeXmlAdapter&quot; /&gt;
        &lt;xjc:javaType name=&quot;java.time.LocalTime&quot; xmlType=&quot;xsd:time&quot; adapter=&quot;com.migesok.jaxb.adapter.javatime.LocalTimeXmlAdapter&quot; /&gt;    </pre>
</body>
</html>